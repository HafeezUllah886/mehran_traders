<?php
 namespace App\Http\Controllers\reports; use App\Http\Controllers\Controller; use App\Models\products; use App\Models\sale_details; use Illuminate\Http\Request; class productSummaryReport extends Controller { public function index() { $topProducts = products::withSum("\163\141\x6c\x65\104\145\x74\141\x69\154\163", "\x71\x74\x79")->withSum("\x73\141\x6c\145\104\x65\164\141\x69\154\x73", "\164\151")->orderByDesc("\163\141\x6c\x65\x5f\x64\x65\164\141\151\154\163\x5f\163\x75\155\137\161\x74\x79")->get(); $topProductsArray = array(); foreach ($topProducts as $product) { $stock = getStock($product->id); $price = avgSalePrice("\x61\x6c\x6c", "\141\x6c\x6c", $product->id); $pprice = avgPurchasePrice("\141\x6c\154", "\141\x6c\x6c", $product->id); $ppu = $price - $pprice; $profit = $ppu * $product->sale_details_sum_qty; $stockValue = $pprice * $stock; $topProductsArray[] = array("\156\141\155\145" => $product->name, "\x63\141\x74" => $product->category->name, "\165\x6e\x69\164" => $product->unit->name, "\165\156\x69\x74\126\x61\x6c\x75\145" => $product->unit->value, "\x70\x72\x69\x63\145" => $price, "\160\x70\162\151\x63\x65" => $pprice, "\160\x72\157\146\151\x74" => $profit, "\x73\x74\157\x63\153" => $stock, "\163\164\x6f\x63\x6b\126\x61\154\165\145" => $stockValue, "\141\x6d\x6f\165\156\164" => $product->sale_details_sum_ti, "\x73\157\154\x64" => $product->sale_details_sum_qty); } return view("\x72\x65\160\x6f\162\164\x73\56\160\x72\157\144\165\x63\x74\123\165\155\155\141\x72\x79\56\144\145\164\x61\x69\x6c\163", compact("\x74\157\160\x50\x72\x6f\144\x75\143\x74\x73\101\x72\162\141\x79")); } }