<?php
 namespace App\Http\Controllers\reports; use App\Http\Controllers\Controller; use App\Models\accounts; use App\Models\products; use App\Models\transactions; use Illuminate\Http\Request; use Illuminate\Support\Facades\DB; use SebastianBergmann\CodeCoverage\Report\Html\CustomCssFile; class comparisonReportController extends Controller { public function index() { $customers = accounts::customer()->get(); return view("\x72\x65\x70\x6f\x72\164\x73\x2e\143\157\x6d\x70\x61\x72\151\x73\x6f\156\56\x69\156\x64\x65\x78", compact("\143\165\163\x74\157\x6d\145\x72\x73")); } public function data($from1, $to1, $from2, $to2, $customer) { $products = products::orderBy("\x63\141\x74\111\x44")->get(); foreach ($products as $product) { $year1Sold = DB::table("\x73\141\154\x65\163")->join("\163\x61\154\145\137\144\x65\164\141\151\x6c\163", "\163\x61\154\x65\x73\56\x69\144", "\x3d", "\163\141\154\x65\x5f\x64\145\164\x61\151\x6c\x73\56\x73\141\x6c\x65\x73\111\104")->where("\163\141\x6c\x65\163\56\143\x75\x73\164\x6f\155\145\162\x49\104", $customer)->where("\x73\141\154\x65\x5f\144\x65\164\x61\x69\154\163\56\x70\x72\x6f\x64\165\x63\164\x49\x44", $product->id)->whereBetween("\163\141\154\x65\x5f\144\x65\x74\x61\x69\154\163\x2e\144\141\x74\x65", array($from1, $to1))->sum("\163\x61\154\145\x5f\x64\x65\x74\141\151\154\163\56\x71\x74\x79"); $year2Sold = DB::table("\x73\x61\154\145\163")->join("\x73\141\x6c\145\x5f\x64\145\x74\x61\x69\x6c\163", "\x73\x61\x6c\x65\x73\56\x69\x64", "\x3d", "\163\141\154\145\x5f\144\145\164\141\x69\x6c\x73\56\163\141\x6c\x65\163\111\x44")->where("\x73\141\x6c\x65\163\x2e\143\165\x73\x74\157\155\145\162\111\104", $customer)->where("\163\x61\x6c\x65\137\x64\x65\164\x61\x69\x6c\163\56\x70\x72\157\144\x75\x63\x74\x49\x44", $product->id)->whereBetween("\x73\x61\x6c\145\x5f\x64\x65\164\x61\x69\x6c\x73\x2e\x64\141\164\145", array($from2, $to2))->sum("\x73\141\x6c\x65\x5f\x64\x65\164\141\x69\154\163\x2e\161\x74\x79"); $product->sold1 = $year1Sold; $product->sold2 = $year2Sold; $growth = calculateGrowthPercentage($year1Sold, $year2Sold); $product->growth = $growth; } $customer = accounts::find($customer); return view("\162\145\x70\157\162\x74\x73\56\143\157\x6d\x70\141\162\151\163\x6f\x6e\x2e\x64\145\164\141\x69\x6c\163", compact("\x66\162\x6f\x6d\61", "\x74\157\61", "\146\x72\157\x6d\x32", "\164\157\x32", "\x63\165\x73\164\157\155\145\x72", "\160\162\157\144\x75\x63\x74\x73")); } }